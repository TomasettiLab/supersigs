<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Using supersigs</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using supersigs</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(supersigs)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>supersigs</code> package implements the supervised method proposed by <em>Afsari, et al.</em> to find signatures (“SuperSigs”). In this vignette, we cover how to preprocess your data and run the method in <code>supersigs</code>.</p>
</div>
<div id="preprocessing-your-data" class="section level1">
<h1>Preprocessing your data</h1>
<div id="example-data" class="section level2">
<h2>Example data</h2>
<p>The method uses single-base mutations in exomic data from cancer samples. Specifically, it requires data on every sample’s mutations, the positions of those mutations, and the age of all patients. This data can be represented as a list of mutations (e.g. in a VCF file). Below is an example dataset (stored and accessible from the <code>supersigs</code> R package).</p>
<ul>
<li><code>sample_id</code> is an ID for each sample</li>
<li><code>age</code> is the age of the patient</li>
<li><code>chromosome</code> and <code>position</code> is the position of the mutation</li>
<li><code>from</code> is the original nucleotide</li>
<li><code>to</code> is the mutated nucleotide</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">print</span>(example_dt)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#&gt;    sample_id age chromosome  position from to</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; 1          1  50       chr1  94447621    G  C</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; 2          1  50       chr2 202005395    A  C</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; 3          1  50       chr7  20784978    T  A</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; 4          1  50       chr7  87179255    C  G</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; 5          1  50      chr19   1059712    G  T</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; 6          2  55       chr1  76226977    T  C</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; 7          2  55       chr3  38180872    C  G</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; 8          2  55       chr9 139905080    G  T</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; 9          2  55      chr16   1562631    G  T</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; 10         2  55      chr22  42189307    C  A</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; 11         3  72       chr1  94447621    T  C</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; 12         3  72       chr2 202005395    A  C</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; 13         3  72       chr7  20784978    T  A</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; 14         3  72       chr7  87179255    A  G</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; 15         3  72      chr19   1059712    T  A</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; 16         4  53       chr1  76226977    G  C</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#&gt; 17         4  53       chr3  38180872    C  G</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#&gt; 18         4  53       chr9 139905080    G  T</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">#&gt; 19         4  53      chr16   1562631    G  T</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">#&gt; 20         4  53      chr22  42189307    G  A</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co">#&gt; 21         5  48       chr1  94447621    A  C</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co">#&gt; 22         5  48       chr2 202005395    C  A</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co">#&gt; 23         5  48       chr7  20784978    T  A</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co">#&gt; 24         5  48       chr7  87179255    G  T</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co">#&gt; 25         5  48      chr19   1059712    G  T</span></span></code></pre></div>
</div>
<div id="transform-data" class="section level2">
<h2>Transform data</h2>
<p>Once you’ve read in your data, you will need to transform it into a data frame of features that is readable by the <code>supersigs</code> package. This involves 2 steps:</p>
<ol style="list-style-type: decimal">
<li><p>First, we assume that mutations are the same regardless of the strand on which it occurred. For example, this means that C&gt;A mutations are considered the same as G&gt;T mutations and we will convert all G&gt;T mutations to be denoted as C&gt;A mutations.</p></li>
<li><p>Because the features used are built upon trinucleotide features (e.g. A[C&gt;A]T), this will require matching your mutations to a reference genome to identify what the flanking bases of every mutation are. In our example below, we will use the <code>hg19</code> reference genome.</p></li>
</ol>
<p>Both of these steps are done by the <code>make_matrix</code> function. Note that using the <code>make_matrix</code> function requires installing and loading a reference genome (<code>BSgenome.Hsapiens.UCSC.hg19</code> and <code>BSgenome.Hsapiens.UCSC.hg38</code> are supported).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Load packages for make_matrix function</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">suppressPackageStartupMessages</span>({</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="kw">library</span>(BSgenome.Hsapiens.UCSC.hg19)</span>
<span id="cb3-4"><a href="#cb3-4"></a>})</span></code></pre></div>
<p>We apply <code>make_matrix</code> to transform our example dataset (<code>example_dt</code>) into a data frame of trinucleotide mutations (<code>input_dt</code>), which is the format required by the <code>supersigs</code> R package. Each row in <code>input_dt</code> corresponds to a different patient and the values in the columns are the number of mutations for each trinucleotide mutation.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>input_dt =<span class="st"> </span><span class="kw">make_matrix</span>(example_dt)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">print</span>(input_dt)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; # A tibble: 5 x 98</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt;   sample_id   age `A[T&gt;G]T` `C[T&gt;A]A` `G[C&gt;A]A` `G[C&gt;G]G` `G[C&gt;G]T` `A[C&gt;G]T`</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; 1         1    50         1         1         1         1         1         0</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt; 2         2    55         0         0         0         0         0         1</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; 3         3    72         1         1         0         0         0         0</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; 4         4    53         0         0         0         0         0         1</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; 5         5    48         0         1         1         0         0         0</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; # … with 90 more variables: `C[C&gt;A]T` &lt;dbl&gt;, `C[T&gt;C]G` &lt;dbl&gt;, `T[C&gt;A]C` &lt;dbl&gt;,</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; #   `T[C&gt;A]T` &lt;dbl&gt;, `A[T&gt;C]C` &lt;dbl&gt;, `C[T&gt;C]C` &lt;dbl&gt;, `T[T&gt;A]C` &lt;dbl&gt;,</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; #   `C[C&gt;G]G` &lt;dbl&gt;, `G[C&gt;T]A` &lt;dbl&gt;, `A[C&gt;A]T` &lt;dbl&gt;, `C[C&gt;A]C` &lt;dbl&gt;,</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt; #   `G[T&gt;G]T` &lt;dbl&gt;, `C[C&gt;T]C` &lt;dbl&gt;, `T[C&gt;T]C` &lt;dbl&gt;, `A[C&gt;T]C` &lt;dbl&gt;,</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt; #   `G[C&gt;T]C` &lt;dbl&gt;, `C[C&gt;T]T` &lt;dbl&gt;, `T[C&gt;T]T` &lt;dbl&gt;, `A[C&gt;T]T` &lt;dbl&gt;,</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt; #   `G[C&gt;T]T` &lt;dbl&gt;, `C[C&gt;T]A` &lt;dbl&gt;, `T[C&gt;T]A` &lt;dbl&gt;, `A[C&gt;T]A` &lt;dbl&gt;,</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt; #   `C[C&gt;T]G` &lt;dbl&gt;, `T[C&gt;T]G` &lt;dbl&gt;, `A[C&gt;T]G` &lt;dbl&gt;, `G[C&gt;T]G` &lt;dbl&gt;,</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt; #   `A[C&gt;A]C` &lt;dbl&gt;, `G[C&gt;A]C` &lt;dbl&gt;, `G[C&gt;A]T` &lt;dbl&gt;, `C[C&gt;A]A` &lt;dbl&gt;,</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">#&gt; #   `T[C&gt;A]A` &lt;dbl&gt;, `A[C&gt;A]A` &lt;dbl&gt;, `C[C&gt;A]G` &lt;dbl&gt;, `T[C&gt;A]G` &lt;dbl&gt;,</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">#&gt; #   `A[C&gt;A]G` &lt;dbl&gt;, `G[C&gt;A]G` &lt;dbl&gt;, `C[C&gt;G]C` &lt;dbl&gt;, `T[C&gt;G]C` &lt;dbl&gt;,</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#&gt; #   `A[C&gt;G]C` &lt;dbl&gt;, `G[C&gt;G]C` &lt;dbl&gt;, `C[C&gt;G]T` &lt;dbl&gt;, `T[C&gt;G]T` &lt;dbl&gt;,</span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="co">#&gt; #   `C[C&gt;G]A` &lt;dbl&gt;, `T[C&gt;G]A` &lt;dbl&gt;, `A[C&gt;G]A` &lt;dbl&gt;, `G[C&gt;G]A` &lt;dbl&gt;,</span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co">#&gt; #   `T[C&gt;G]G` &lt;dbl&gt;, `A[C&gt;G]G` &lt;dbl&gt;, `T[T&gt;C]C` &lt;dbl&gt;, `G[T&gt;C]C` &lt;dbl&gt;,</span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="co">#&gt; #   `C[T&gt;C]T` &lt;dbl&gt;, `T[T&gt;C]T` &lt;dbl&gt;, `A[T&gt;C]T` &lt;dbl&gt;, `G[T&gt;C]T` &lt;dbl&gt;,</span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="co">#&gt; #   `C[T&gt;C]A` &lt;dbl&gt;, `T[T&gt;C]A` &lt;dbl&gt;, `A[T&gt;C]A` &lt;dbl&gt;, `G[T&gt;C]A` &lt;dbl&gt;,</span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="co">#&gt; #   `T[T&gt;C]G` &lt;dbl&gt;, `A[T&gt;C]G` &lt;dbl&gt;, `G[T&gt;C]G` &lt;dbl&gt;, `C[T&gt;A]C` &lt;dbl&gt;,</span></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="co">#&gt; #   `A[T&gt;A]C` &lt;dbl&gt;, `G[T&gt;A]C` &lt;dbl&gt;, `C[T&gt;A]T` &lt;dbl&gt;, `T[T&gt;A]T` &lt;dbl&gt;,</span></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="co">#&gt; #   `A[T&gt;A]T` &lt;dbl&gt;, `G[T&gt;A]T` &lt;dbl&gt;, `T[T&gt;A]A` &lt;dbl&gt;, `A[T&gt;A]A` &lt;dbl&gt;,</span></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="co">#&gt; #   `G[T&gt;A]A` &lt;dbl&gt;, `C[T&gt;A]G` &lt;dbl&gt;, `T[T&gt;A]G` &lt;dbl&gt;, `A[T&gt;A]G` &lt;dbl&gt;,</span></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="co">#&gt; #   `G[T&gt;A]G` &lt;dbl&gt;, `C[T&gt;G]C` &lt;dbl&gt;, `T[T&gt;G]C` &lt;dbl&gt;, `A[T&gt;G]C` &lt;dbl&gt;,</span></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="co">#&gt; #   `G[T&gt;G]C` &lt;dbl&gt;, `C[T&gt;G]T` &lt;dbl&gt;, `T[T&gt;G]T` &lt;dbl&gt;, `C[T&gt;G]A` &lt;dbl&gt;,</span></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="co">#&gt; #   `T[T&gt;G]A` &lt;dbl&gt;, `A[T&gt;G]A` &lt;dbl&gt;, `G[T&gt;G]A` &lt;dbl&gt;, `C[T&gt;G]G` &lt;dbl&gt;,</span></span>
<span id="cb4-33"><a href="#cb4-33"></a><span class="co">#&gt; #   `T[T&gt;G]G` &lt;dbl&gt;, `A[T&gt;G]G` &lt;dbl&gt;, `G[T&gt;G]G` &lt;dbl&gt;</span></span></code></pre></div>
</div>
</div>
<div id="getting-your-signature" class="section level1">
<h1>Getting your signature</h1>
<p>To apply the supervised method on your data, run the <code>get_signature</code> function. The function has two parameters: an input data frame <code>dt</code> and the <code>factor</code> (e.g. <code>factor = &quot;Smoking&quot;</code>). <code>dt</code> is a data frame with the following columns:</p>
<ul>
<li><code>sample_id</code> is an ID for each sample</li>
<li><code>age</code> is the age of the patient</li>
<li><code>IndVar</code> (indicator variable) is a logical indicator for whether they were exposed to the <code>factor</code> or not</li>
<li>columns of counts for all 96 trinucleotide mutations</li>
</ul>
<p>The process of converting a VCF file to this format is covered in <a href="#preprocessing-your-data">Preprocessing your data</a>. An example for <code>dt</code> is printed below.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Generate synthetic IndVar column</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>input_dt<span class="op">$</span>IndVar =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">print</span>(input_dt)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt; # A tibble: 5 x 99</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;   sample_id   age `A[T&gt;G]T` `C[T&gt;A]A` `G[C&gt;A]A` `G[C&gt;G]G` `G[C&gt;G]T` `A[C&gt;G]T`</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt; 1         1    50         1         1         1         1         1         0</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; 2         2    55         0         0         0         0         0         1</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt; 3         3    72         1         1         0         0         0         0</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt; 4         4    53         0         0         0         0         0         1</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt; 5         5    48         0         1         1         0         0         0</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt; # … with 91 more variables: `C[C&gt;A]T` &lt;dbl&gt;, `C[T&gt;C]G` &lt;dbl&gt;, `T[C&gt;A]C` &lt;dbl&gt;,</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt; #   `T[C&gt;A]T` &lt;dbl&gt;, `A[T&gt;C]C` &lt;dbl&gt;, `C[T&gt;C]C` &lt;dbl&gt;, `T[T&gt;A]C` &lt;dbl&gt;,</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt; #   `C[C&gt;G]G` &lt;dbl&gt;, `G[C&gt;T]A` &lt;dbl&gt;, `A[C&gt;A]T` &lt;dbl&gt;, `C[C&gt;A]C` &lt;dbl&gt;,</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt; #   `G[T&gt;G]T` &lt;dbl&gt;, `C[C&gt;T]C` &lt;dbl&gt;, `T[C&gt;T]C` &lt;dbl&gt;, `A[C&gt;T]C` &lt;dbl&gt;,</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt; #   `G[C&gt;T]C` &lt;dbl&gt;, `C[C&gt;T]T` &lt;dbl&gt;, `T[C&gt;T]T` &lt;dbl&gt;, `A[C&gt;T]T` &lt;dbl&gt;,</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt; #   `G[C&gt;T]T` &lt;dbl&gt;, `C[C&gt;T]A` &lt;dbl&gt;, `T[C&gt;T]A` &lt;dbl&gt;, `A[C&gt;T]A` &lt;dbl&gt;,</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">#&gt; #   `C[C&gt;T]G` &lt;dbl&gt;, `T[C&gt;T]G` &lt;dbl&gt;, `A[C&gt;T]G` &lt;dbl&gt;, `G[C&gt;T]G` &lt;dbl&gt;,</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">#&gt; #   `A[C&gt;A]C` &lt;dbl&gt;, `G[C&gt;A]C` &lt;dbl&gt;, `G[C&gt;A]T` &lt;dbl&gt;, `C[C&gt;A]A` &lt;dbl&gt;,</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#&gt; #   `T[C&gt;A]A` &lt;dbl&gt;, `A[C&gt;A]A` &lt;dbl&gt;, `C[C&gt;A]G` &lt;dbl&gt;, `T[C&gt;A]G` &lt;dbl&gt;,</span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">#&gt; #   `A[C&gt;A]G` &lt;dbl&gt;, `G[C&gt;A]G` &lt;dbl&gt;, `C[C&gt;G]C` &lt;dbl&gt;, `T[C&gt;G]C` &lt;dbl&gt;,</span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">#&gt; #   `A[C&gt;G]C` &lt;dbl&gt;, `G[C&gt;G]C` &lt;dbl&gt;, `C[C&gt;G]T` &lt;dbl&gt;, `T[C&gt;G]T` &lt;dbl&gt;,</span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">#&gt; #   `C[C&gt;G]A` &lt;dbl&gt;, `T[C&gt;G]A` &lt;dbl&gt;, `A[C&gt;G]A` &lt;dbl&gt;, `G[C&gt;G]A` &lt;dbl&gt;,</span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">#&gt; #   `T[C&gt;G]G` &lt;dbl&gt;, `A[C&gt;G]G` &lt;dbl&gt;, `T[T&gt;C]C` &lt;dbl&gt;, `G[T&gt;C]C` &lt;dbl&gt;,</span></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">#&gt; #   `C[T&gt;C]T` &lt;dbl&gt;, `T[T&gt;C]T` &lt;dbl&gt;, `A[T&gt;C]T` &lt;dbl&gt;, `G[T&gt;C]T` &lt;dbl&gt;,</span></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">#&gt; #   `C[T&gt;C]A` &lt;dbl&gt;, `T[T&gt;C]A` &lt;dbl&gt;, `A[T&gt;C]A` &lt;dbl&gt;, `G[T&gt;C]A` &lt;dbl&gt;,</span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co">#&gt; #   `T[T&gt;C]G` &lt;dbl&gt;, `A[T&gt;C]G` &lt;dbl&gt;, `G[T&gt;C]G` &lt;dbl&gt;, `C[T&gt;A]C` &lt;dbl&gt;,</span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co">#&gt; #   `A[T&gt;A]C` &lt;dbl&gt;, `G[T&gt;A]C` &lt;dbl&gt;, `C[T&gt;A]T` &lt;dbl&gt;, `T[T&gt;A]T` &lt;dbl&gt;,</span></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">#&gt; #   `A[T&gt;A]T` &lt;dbl&gt;, `G[T&gt;A]T` &lt;dbl&gt;, `T[T&gt;A]A` &lt;dbl&gt;, `A[T&gt;A]A` &lt;dbl&gt;,</span></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="co">#&gt; #   `G[T&gt;A]A` &lt;dbl&gt;, `C[T&gt;A]G` &lt;dbl&gt;, `T[T&gt;A]G` &lt;dbl&gt;, `A[T&gt;A]G` &lt;dbl&gt;,</span></span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="co">#&gt; #   `G[T&gt;A]G` &lt;dbl&gt;, `C[T&gt;G]C` &lt;dbl&gt;, `T[T&gt;G]C` &lt;dbl&gt;, `A[T&gt;G]C` &lt;dbl&gt;,</span></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="co">#&gt; #   `G[T&gt;G]C` &lt;dbl&gt;, `C[T&gt;G]T` &lt;dbl&gt;, `T[T&gt;G]T` &lt;dbl&gt;, `C[T&gt;G]A` &lt;dbl&gt;,</span></span>
<span id="cb5-33"><a href="#cb5-33"></a><span class="co">#&gt; #   `T[T&gt;G]A` &lt;dbl&gt;, `A[T&gt;G]A` &lt;dbl&gt;, `G[T&gt;G]A` &lt;dbl&gt;, `C[T&gt;G]G` &lt;dbl&gt;,</span></span>
<span id="cb5-34"><a href="#cb5-34"></a><span class="co">#&gt; #   `T[T&gt;G]G` &lt;dbl&gt;, `A[T&gt;G]G` &lt;dbl&gt;, `G[T&gt;G]G` &lt;dbl&gt;, IndVar &lt;dbl&gt;</span></span></code></pre></div>
<p>Once you have the correct data format, apply <code>get_signature</code> to the dataset to get your <code>SuperSig</code>. This is an S4 object containing four slots:</p>
<ul>
<li><code>Signature</code> is the signature, represented as their differences in mean rates (or counts if the factor is “age”) between the two groups (exposed versus unexposed)</li>
<li><code>Features</code> is the list of features that comprise the signature and their representation in terms of the fundamental (trinucleotide) mutations</li>
<li><code>AUC</code> is the apparent AUC of the model (i.e. not cross-validated)</li>
<li><code>Model</code> is the list of a glm class for the trained logistic regression model</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>out =<span class="st"> </span><span class="kw">get_signature</span>(<span class="dt">dt =</span> input_dt, <span class="dt">factor =</span> <span class="st">&quot;Smoking&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; Begin feature engineering...</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; Begin cross-validated selection over 4 features and 15 inner folds...</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; ...testing inner fold 1</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; ...testing inner fold 2</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; ...testing inner fold 3</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; ...testing inner fold 4</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; ...testing inner fold 5</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; ...testing inner fold 6</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; ...testing inner fold 7</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; ...testing inner fold 8</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; ...testing inner fold 9</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; ...testing inner fold 10</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt; ...testing inner fold 11</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt; ...testing inner fold 12</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; ...testing inner fold 13</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; ...testing inner fold 14</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; ...testing inner fold 15</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>out</span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; Signature:</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt;             F1</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">#&gt; 1 0.0001976337</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">#&gt; Features:</span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">#&gt; $F1</span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">#&gt;        F4 </span></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="co">#&gt; &quot;A[T&gt;G]T&quot; </span></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co">#&gt; </span></span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="co">#&gt; Model:</span></span>
<span id="cb6-29"><a href="#cb6-29"></a><span class="co">#&gt; $Logit</span></span>
<span id="cb6-30"><a href="#cb6-30"></a><span class="co">#&gt; </span></span>
<span id="cb6-31"><a href="#cb6-31"></a><span class="co">#&gt; Call:  glm(formula = IndVar ~ ., family = binomial(), data = x)</span></span>
<span id="cb6-32"><a href="#cb6-32"></a><span class="co">#&gt; </span></span>
<span id="cb6-33"><a href="#cb6-33"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="co">#&gt; (Intercept)           F1  </span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="co">#&gt;     -0.6931    1382.0538  </span></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="co">#&gt; </span></span>
<span id="cb6-37"><a href="#cb6-37"></a><span class="co">#&gt; Degrees of Freedom: 4 Total (i.e. Null);  3 Residual</span></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="co">#&gt; Null Deviance:       6.73 </span></span>
<span id="cb6-39"><a href="#cb6-39"></a><span class="co">#&gt; Residual Deviance: 3.819     AIC: 7.819</span></span></code></pre></div>
</div>
<div id="using-your-signature" class="section level1">
<h1>Using your signature</h1>
<p>To apply the <code>SuperSig</code> to a new dataset, you can use the <code>predict_signature</code> function. This function returns the new dataset with columns for feature counts for the signature and a score column for the predicted classification score.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>newdata =<span class="st"> </span><span class="kw">predict_signature</span>(out, <span class="dt">newdata =</span> input_dt, <span class="dt">factor =</span> <span class="st">&quot;Smoking&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">suppressPackageStartupMessages</span>({</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="kw">library</span>(dplyr)</span>
<span id="cb7-5"><a href="#cb7-5"></a>})</span>
<span id="cb7-6"><a href="#cb7-6"></a>newdata <span class="op">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="st">  </span><span class="kw">select</span>(IndVar, F1, score)</span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; # A tibble: 5 x 3</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt;   IndVar     F1 score</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt; 1      1 0.02   1.00 </span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; 2      1 0      0.333</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; 3      1 0.0139 1.00 </span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; 4      0 0      0.333</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; 5      0 0      0.333</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
